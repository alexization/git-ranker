<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Git Ranker - 개발자 전투력 측정기</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .hero-section {
            background: linear-gradient(135deg, #24292e 0%, #2b3137 100%);
            color: white;
            padding: 3rem 0;
            margin-bottom: 2rem;
        }

        .stat-card {
            transition: transform 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .tier-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* 티어별 색상 */
        .text-DIAMOND {
            color: #b9f2ff;
            text-shadow: 0 0 10px #00d4ff;
        }

        .text-PLATINUM {
            color: #00ced1;
        }

        .text-GOLD {
            color: #ffd700;
        }

        .text-SILVER {
            color: #c0c0c0;
        }

        .text-BRONZE {
            color: #cd7f32;
        }

        .text-IRON {
            color: #5f5f5f;
        }

        .diff-badge {
            font-size: 0.75rem;
            vertical-align: middle; /* 중앙 정렬 */
            margin-left: 5px;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 9999;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
        }
    </style>
</head>
<body>

<div id="loadingOverlay" class="loading-overlay">
    <div class="spinner-border text-light" style="width: 3rem; height: 3rem;" role="status"></div>
    <div class="mt-3 fs-4">GitHub 데이터를 분석 중입니다...</div>
    <div class="text-white-50 small">(최대 10초 정도 소요될 수 있습니다)</div>
</div>

<header class="hero-section">
    <div class="container text-center">
        <h1 class="display-4 fw-bold"><i class="fab fa-github"></i> Git Ranker</h1>
        <p class="lead">단순 커밋 수가 아닌, <strong>코드의 품질과 기여도</strong>로 당신의 티어를 확인하세요.</p>

        <div class="row justify-content-center mt-4">
            <div class="col-md-8">
                <div class="alert alert-dark border-0 bg-dark bg-opacity-50 text-light text-start" role="alert">
                    <h5 class="alert-heading fs-6"><i class="fas fa-info-circle"></i> 유의사항 및 점수 산정 기준</h5>
                    <ul class="mb-0 small ps-3">
                        <li>Public Repository의 지난 1년 간 활동 데이터만 집계됩니다.</li>
                        <li>점수: Commit(1점), Issue(2점), Review(3점), PR Open(5점), PR Merged(10점).</li>
                        <li>이미 등록된 사용자는 매일 새벽 자동으로 점수가 갱신됩니다.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</header>

<main class="container">
    <section class="row justify-content-center mb-5">
        <div class="col-md-6">
            <div class="input-group input-group-lg shadow-sm">
                <span class="input-group-text bg-white"><i class="fab fa-github"></i></span>
                <input type="text" id="usernameInput" class="form-control"
                       placeholder="GitHub Username 입력 (예: alexization)" aria-label="Username">
                <button class="btn btn-dark px-4" type="button" onclick="registerUser()">분석하기</button>
            </div>
        </div>
    </section>

    <section id="resultSection" class="mb-5 d-none">
        <div class="card shadow border-0">
            <div class="card-body p-4">
                <div class="row align-items-center">
                    <div class="col-lg-4 text-center border-end-lg mb-4 mb-lg-0">
                        <img id="resProfileImage" src="" alt="Profile" class="rounded-circle mb-3 shadow-sm" width="120"
                             height="120">
                        <div>
                            <i id="resTierIcon" class="fas fa-gem tier-icon"></i>
                            <h3 id="resTierText" class="fw-bold mb-1"></h3>
                            <p class="text-muted mb-0">
                                상위 <span id="resPercentile" class="fw-bold text-dark"></span>%
                                (<span id="resRanking"></span>위)
                            </p>
                        </div>
                    </div>

                    <div class="col-lg-8">
                        <div class="text-center mb-4">
                            <h5 class="text-muted text-uppercase small ls-1">Total Score</h5>
                            <h1 class="display-3 fw-bold text-primary" id="resTotalScore"></h1>
                            <p class="text-muted small">최종 업데이트: <span id="resUpdatedAt"></span></p>

                            <div class="d-flex justify-content-center gap-2">
                                <button class="btn btn-outline-dark btn-sm" onclick="copyBadgeMarkdown()">
                                    <i class="fab fa-markdown"></i> README 배지 복사
                                </button>
                                <input type="hidden" id="resNodeId"></div>
                        </div>

                        <div class="row g-3 text-center">
                            <div class="col-4 col-md">
                                <div class="p-3 bg-light rounded stat-card">
                                    <div class="fs-4 text-secondary mb-1"><i class="fas fa-code-branch"></i></div>
                                    <div class="small text-muted">Commits</div>
                                    <div class="fw-bold fs-5">
                                        <span id="statCommit">0</span>
                                        <span id="diffCommit" class="badge rounded-pill bg-success diff-badge"
                                              style="display: none;"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-4 col-md">
                                <div class="p-3 bg-light rounded stat-card">
                                    <div class="fs-4 text-warning mb-1"><i class="fas fa-exclamation-circle"></i></div>
                                    <div class="small text-muted">Issues</div>
                                    <div class="fw-bold fs-5">
                                        <span id="statIssue">0</span>
                                        <span id="diffIssue" class="badge rounded-pill bg-danger diff-badge"
                                              style="display: none;"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-4 col-md">
                                <div class="p-3 bg-light rounded stat-card">
                                    <div class="fs-4 text-info mb-1"><i class="fas fa-glasses"></i></div>
                                    <div class="small text-muted">Reviews</div>
                                    <div class="fw-bold fs-5">
                                        <span id="statReview">0</span>
                                        <span id="diffReview" class="badge rounded-pill bg-success diff-badge"
                                              style="display: none;"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md">
                                <div class="p-3 bg-light rounded stat-card">
                                    <div class="fs-4 text-success mb-1"><i class="fas fa-share-square"></i></div>
                                    <div class="small text-muted">PR Open</div>
                                    <div class="fw-bold fs-5">
                                        <span id="statPrOpen">0</span>
                                        <span id="diffPrOpen" class="badge rounded-pill bg-secondary diff-badge"
                                              style="display: none;"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md">
                                <div class="p-3 bg-light rounded stat-card">
                                    <div class="fs-4 text-purple mb-1" style="color: #6f42c1;"><i
                                            class="fas fa-check-double"></i></div>
                                    <div class="small text-muted">PR Merged</div>
                                    <div class="fw-bold fs-5">
                                        <span id="statPrMerged">0</span>
                                        <span id="diffPrMerged" class="badge rounded-pill bg-success diff-badge"
                                              style="display: none;"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="row justify-content-center mb-4">
        <div class="col-md-8 text-center">
            <div class="alert alert-light border shadow-sm d-inline-block px-5 py-3">
                <h5 class="mb-2 text-secondary fw-bold">
                    <i class="fas fa-stopwatch text-primary me-1"></i> 다음 랭킹 갱신까지
                    <span id="countdownTimer" class="fw-bold text-dark ms-2 text-monospace"
                          style="font-family: monospace;">--분 --초</span>
                </h5>
                <p class="mb-0 small text-muted">
                    <i class="fas fa-sync-alt fa-spin me-1" style="font-size: 0.7rem;"></i>
                    매 정각마다 전체 순위와 티어가 자동으로 재산정됩니다.
                </p>
            </div>
        </div>
    </section>

    <section class="mb-5">
        <h3 class="fw-bold mb-4"><i class="fas fa-trophy text-warning"></i> 전체 랭킹 (Top 100)</h3>
        <div class="card shadow-sm">
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0 text-center">
                    <thead class="table-light">
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Tier</th>
                        <th scope="col" class="text-start">User</th>
                        <th scope="col">Total Score</th>
                        <th scope="col">Detail</th>
                    </tr>
                    </thead>
                    <tbody id="rankingTableBody">
                    <tr>
                        <td colspan="6" class="py-4 text-muted">랭킹 데이터를 불러오는 중...</td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="card-footer bg-white py-3">
                <nav>
                    <ul class="pagination justify-content-center mb-0" id="pagination">
                    </ul>
                </nav>
            </div>
        </div>
    </section>
</main>

<footer class="bg-dark text-white py-4 mt-5">
    <div class="container text-center">
        <p class="mb-1">&copy; 2025 Git Ranker. All rights reserved.</p>
        <p class="small text-white-50">
            Designed by <a href="https://github.com/alexization" class="text-white text-decoration-underline"
                           target="_blank">@alexization</a>
        </p>
    </div>
</footer>

<div class="modal fade" id="userDetailModal" tabindex="-1" aria-labelledby="userDetailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header border-0 pb-0">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center pb-5 pt-0">
                <div class="mb-4">
                    <img id="modalProfileImage" src="" alt="Profile" class="rounded-circle shadow-sm mb-3" width="100"
                         height="100">
                    <h3 id="modalUsername" class="fw-bold mb-1"></h3>
                    <div id="modalTierBadge"
                         class="d-inline-block px-3 py-1 rounded-pill bg-light fw-bold border mb-2"></div>
                    <p class="text-muted small mb-0">
                        전체 <span id="modalRanking" class="fw-bold text-dark"></span>위
                        (상위 <span id="modalPercentile" class="fw-bold text-dark"></span>%)
                    </p>
                </div>

                <div class="mb-4">
                    <h2 class="display-4 fw-bold text-primary mb-0" id="modalTotalScore"></h2>
                    <span class="text-muted small text-uppercase ls-1">Total Score</span>
                </div>

                <div class="row g-2 justify-content-center">
                    <div class="col-4">
                        <div class="p-2 bg-light rounded border">
                            <div class="small text-muted"><i class="fas fa-code-branch"></i> Commits</div>
                            <div class="fw-bold fs-5" id="modalStatCommit">0</div>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="p-2 bg-light rounded border">
                            <div class="small text-muted"><i class="fas fa-exclamation-circle"></i> Issues</div>
                            <div class="fw-bold fs-5" id="modalStatIssue">0</div>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="p-2 bg-light rounded border">
                            <div class="small text-muted"><i class="fas fa-glasses"></i> Reviews</div>
                            <div class="fw-bold fs-5" id="modalStatReview">0</div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="p-2 bg-light rounded border">
                            <div class="small text-muted"><i class="fas fa-share-square"></i> PR Open</div>
                            <div class="fw-bold fs-5" id="modalStatPrOpen">0</div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="p-2 bg-light rounded border">
                            <div class="small text-muted"><i class="fas fa-check-double"></i> PR Merged</div>
                            <div class="fw-bold fs-5" id="modalStatPrMerged">0</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    const API_BASE_URL = '/api/v1';

    document.addEventListener('DOMContentLoaded', () => {
        loadRankings(0);
        startCountdownTimer();

        document.getElementById('usernameInput').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                registerUser();
            }
        });
    });

    // ---------------------------------------------------------
    // 랭킹 리스트 조회 및 렌더링
    // ---------------------------------------------------------
    async function loadRankings(page) {
        try {
            const response = await fetch(`${API_BASE_URL}/ranking?page=${page}`);
            const result = await response.json();

            if (result.result === 'SUCCESS') {
                const {rankings, pageInfo} = result.data;
                renderRankingTable(rankings);
                renderPagination(pageInfo);
            } else {
                console.error('랭킹 조회 실패:', result.error.message);
                document.getElementById('rankingTableBody').innerHTML =
                    `<tr><td colspan="5" class="text-danger">랭킹 정보를 불러오지 못했습니다.</td></tr>`;
            }

        } catch (error) {
            console.error('Ranking Load Error:', error);
            document.getElementById('rankingTableBody').innerHTML =
                `<tr><td colspan="5" class="text-danger">서버 통신 중 오류가 발생했습니다.</td></tr>`;
        }
    }

    function renderRankingTable(users) {
        const tbody = document.getElementById('rankingTableBody');
        tbody.innerHTML = '';

        if (!users || users.length === 0) {
            tbody.innerHTML = `<tr><td colspan="5" class="py-4">등록된 랭킹 데이터가 없습니다.</td></tr>`;
            return;
        }

        users.forEach((user) => {
            const row = `
                <tr>
                    <td class="fw-bold">${user.ranking}</td>
                    <td><span class="badge bg-light text-dark border text-${user.tier}">${user.tier}</span></td>
                    <td class="text-start">
                        <img src="${user.profileImage}" class="rounded-circle me-2" width="30" height="30" alt="profile">
                        <a href="https://github.com/${user.username}" target="_blank" class="text-decoration-none text-dark fw-bold">
                            ${user.username}
                        </a>
                    </td>
                    <td class="fw-bold text-primary">${user.totalScore.toLocaleString()}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-secondary" onclick="openUserDetail('${user.username}')">View</button>
                    </td>
                </tr>
            `;
            tbody.innerHTML += row;
        });
    }

    // [추가] 사용자 상세 정보 Modal 열기
    async function openUserDetail(username) {
        // Modal 인스턴스 생성 또는 가져오기
        const modalElement = document.getElementById('userDetailModal');
        const modal = new bootstrap.Modal(modalElement);

        try {
            // API 호출
            const response = await fetch(`${API_BASE_URL}/users/${username}`);
            const result = await response.json();

            if (result.result === 'SUCCESS') {
                const data = result.data;

                // 데이터 바인딩
                document.getElementById('modalProfileImage').src = data.profileImage;
                document.getElementById('modalUsername').innerText = data.username;

                // 티어 뱃지 설정
                const tierEl = document.getElementById('modalTierBadge');
                tierEl.className = `d-inline-block px-3 py-1 rounded-pill fw-bold border mb-2 text-${data.tier}`;
                tierEl.innerHTML = `<i class="${getTierIconClass(data.tier)} me-1"></i> ${data.tier}`;

                document.getElementById('modalRanking').innerText = data.ranking;
                document.getElementById('modalPercentile').innerText = data.percentile.toFixed(2);
                document.getElementById('modalTotalScore').innerText = data.totalScore.toLocaleString();

                // 상세 스탯 (ActivityLog 데이터가 없을 경우 0 처리)
                document.getElementById('modalStatCommit').innerText = (data.commitCount || 0).toLocaleString();
                document.getElementById('modalStatIssue').innerText = (data.issueCount || 0).toLocaleString();
                document.getElementById('modalStatReview').innerText = (data.reviewCount || 0).toLocaleString();
                document.getElementById('modalStatPrOpen').innerText = (data.prCount || 0).toLocaleString();
                document.getElementById('modalStatPrMerged').innerText = (data.mergedPrCount || 0).toLocaleString();

                // Modal 표시
                modal.show();
            } else {
                alert('사용자 정보를 불러올 수 없습니다.');
            }
        } catch (error) {
            console.error('User Detail Error:', error);
            alert('상세 정보를 불러오는 중 오류가 발생했습니다.');
        }
    }

    // 페이지네이션 렌더링 (이전과 동일)
    function renderPagination(pageInfo) {
        const pagination = document.getElementById('pagination');
        pagination.innerHTML = '';

        const currentPage = pageInfo.currentPage;
        const totalPages = pageInfo.totalPages;
        const pageSize = 5;
        const startPage = Math.floor(currentPage / pageSize) * pageSize;
        const endPage = Math.min(startPage + pageSize, totalPages);

        const prevDisabled = pageInfo.first ? 'disabled' : '';
        pagination.innerHTML += `
            <li class="page-item ${prevDisabled}">
                <a class="page-link" href="#" onclick="loadRankings(${currentPage - 1}); return false;">&laquo;</a>
            </li>
        `;

        for (let i = startPage; i < endPage; i++) {
            const activeClass = (i === currentPage) ? 'active' : '';
            pagination.innerHTML += `
                <li class="page-item ${activeClass}">
                    <a class="page-link" href="#" onclick="loadRankings(${i}); return false;">${i + 1}</a>
                </li>
            `;
        }

        const nextDisabled = pageInfo.last ? 'disabled' : '';
        pagination.innerHTML += `
            <li class="page-item ${nextDisabled}">
                <a class="page-link" href="#" onclick="loadRankings(${currentPage + 1}); return false;">&raquo;</a>
            </li>
        `;
    }

    // ---------------------------------------------------------
    // 기타 기능 (타이머, 사용자 등록, 결과 카드) - 이전과 동일
    // ---------------------------------------------------------
    function startCountdownTimer() {
        function update() {
            const now = new Date();
            const nextHour = new Date(now);
            nextHour.setHours(now.getHours() + 1);
            nextHour.setMinutes(0);
            nextHour.setSeconds(0);
            nextHour.setMilliseconds(0);

            const diff = nextHour - now;
            const m = Math.floor(diff / 60000);
            const s = Math.floor((diff % 60000) / 1000);

            const mStr = String(m).padStart(2, '0');
            const sStr = String(s).padStart(2, '0');

            const timerEl = document.getElementById('countdownTimer');
            if (timerEl) timerEl.innerText = `${mStr}분 ${sStr}초`;
        }

        update();
        setInterval(update, 1000);
    }

    async function registerUser() {
        const username = document.getElementById('usernameInput').value.trim();
        if (!username) {
            alert('GitHub Username을 입력해주세요.');
            return;
        }
        showLoading(true);
        try {
            const response = await fetch(`${API_BASE_URL}/users`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({username: username})
            });
            const result = await response.json();
            if (result.result === 'SUCCESS') {
                renderUserResult(result.data);
                loadRankings(0);
            } else {
                alert(`오류 발생: ${result.error.message}`);
            }
        } catch (error) {
            console.error('API Error:', error);
            alert('서버와 통신 중 오류가 발생했습니다.');
        } finally {
            showLoading(false);
        }
    }

    function renderUserResult(data) {
        const section = document.getElementById('resultSection');
        section.classList.remove('d-none');
        document.getElementById('resNodeId').value = data.nodeId;
        document.getElementById('resProfileImage').src = data.profileImage;
        document.getElementById('resTierText').innerText = data.tier;
        document.getElementById('resTierText').className = `fw-bold mb-1 text-${data.tier}`;
        document.getElementById('resPercentile').innerText = data.percentile ? data.percentile.toFixed(2) : '0.00';
        document.getElementById('resRanking').innerText = data.ranking;
        document.getElementById('resTotalScore').innerText = data.totalScore ? data.totalScore.toLocaleString() : '0';
        document.getElementById('resUpdatedAt').innerText = new Date().toLocaleDateString();

        updateStatWithDiff('statCommit', 'diffCommit', data.commitCount || 0, data.diffCommitCount || 0);
        updateStatWithDiff('statIssue', 'diffIssue', data.issueCount || 0, data.diffIssueCount || 0);
        updateStatWithDiff('statReview', 'diffReview', data.reviewCount || 0, data.diffReviewCount || 0);
        updateStatWithDiff('statPrOpen', 'diffPrOpen', data.prCount || 0, data.diffPrCount || 0);
        updateStatWithDiff('statPrMerged', 'diffPrMerged', data.mergedPrCount || 0, data.diffMergedPrCount || 0);

        const iconClass = getTierIconClass(data.tier);
        document.getElementById('resTierIcon').className = `${iconClass} tier-icon text-${data.tier}`;
        section.scrollIntoView({behavior: 'smooth', block: 'center'});
    }

    // [수정] 배지 마크다운 복사 기능 (HTTP/HTTPS 호환성 개선)
    function copyBadgeMarkdown() {
        const nodeIdInput = document.getElementById('resNodeId');
        const usernameInput = document.getElementById('usernameInput');

        // 요소가 없는 경우 방어 로직
        if (!nodeIdInput || !usernameInput) {
            alert('페이지 로딩 중 오류가 발생했습니다. 새로고침 후 다시 시도해주세요.');
            return;
        }

        const nodeId = nodeIdInput.value;
        const username = usernameInput.value || 'user';

        if (!nodeId) {
            alert('사용자 정보를 찾을 수 없습니다. 다시 진단해주세요.');
            return;
        }

        const origin = window.location.origin;
        const badgeUrl = `${origin}/api/v1/badges/${nodeId}`;
        const targetLink = `https://github.com/${username}`;
        const markdown = `[![Git Ranker](${badgeUrl})](${targetLink})`;

        // 1. 최신 Clipboard API 지원 여부 확인 (HTTPS 환경)
        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(markdown)
                .then(() => {
                    alert('README.md에 붙여넣을 수 있는 코드가 복사되었습니다!');
                })
                .catch(err => {
                    console.error('Clipboard API 실패:', err);
                    fallbackCopyTextToClipboard(markdown); // 실패 시 Fallback 시도
                });
        } else {
            // 2. HTTP 환경 등에서 Clipboard API 사용 불가 시 Fallback 처리
            fallbackCopyTextToClipboard(markdown);
        }
    }

    // [추가] Fallback 복사 함수 (textarea 활용 방식)
    function fallbackCopyTextToClipboard(text) {
        try {
            const textArea = document.createElement("textarea");
            textArea.value = text;

            // 화면 밖으로 보내서 안 보이게 처리
            textArea.style.position = "fixed";
            textArea.style.left = "-9999px";
            textArea.style.top = "0";

            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();

            const successful = document.execCommand('copy');
            document.body.removeChild(textArea);

            if (successful) {
                alert('README.md에 붙여넣을 수 있는 코드가 복사되었습니다!');
            } else {
                throw new Error('execCommand 실패');
            }
        } catch (err) {
            console.error('Fallback 복사 실패:', err);
            // 최후의 수단: 프롬프트 창 띄우기
            prompt('자동 복사를 지원하지 않는 환경입니다. 아래 코드를 직접 복사(Ctrl+C)하세요:', text);
        }
    }

    function updateStatWithDiff(statId, diffId, totalValue, diffValue) {
        document.getElementById(statId).innerText = totalValue.toLocaleString();
        const diffEl = document.getElementById(diffId);
        if (diffValue > 0) {
            diffEl.className = 'badge rounded-pill bg-success diff-badge';
            diffEl.innerText = `+${diffValue}`;
            diffEl.style.display = 'inline-block';
        } else if (diffValue < 0) {
            diffEl.className = 'badge rounded-pill bg-danger diff-badge';
            diffEl.innerText = `${diffValue}`;
            diffEl.style.display = 'inline-block';
        } else {
            diffEl.style.display = 'none';
        }
    }

    function getTierIconClass(tier) {
        switch (tier) {
            case 'DIAMOND':
                return 'fas fa-gem';
            case 'PLATINUM':
                return 'fas fa-medal';
            case 'GOLD':
                return 'fas fa-medal';
            case 'SILVER':
                return 'fas fa-medal';
            case 'BRONZE':
                return 'fas fa-medal';
            default:
                return 'fas fa-shield-alt';
        }
    }

    function showLoading(isLoading) {
        const overlay = document.getElementById('loadingOverlay');
        overlay.style.display = isLoading ? 'flex' : 'none';
    }
</script>
</body>
</html>