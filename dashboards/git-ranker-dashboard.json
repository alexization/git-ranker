{
  "annotations": {
    "list": []
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
      "id": 100,
      "panels": [],
      "title": "üö¶ Golden Signals (System Health)",
      "type": "row"
    },
    {
      "gridPos": { "h": 8, "w": 6, "x": 0, "y": 1 },
      "id": 1,
      "title": "Request Rate (RPS)",
      "type": "timeseries",
      "datasource": { "type": "loki", "uid": "${datasource}" },
      "targets": [
        { "expr": "sum(rate({app=\"api\", event_type=\"REQUEST\"}[1m]))", "legendFormat": "Total Requests" }
      ]
    },
    {
      "gridPos": { "h": 8, "w": 6, "x": 6, "y": 1 },
      "id": 2,
      "title": "Error Rate (%)",
      "type": "stat",
      "datasource": { "type": "loki", "uid": "${datasource}" },
      "targets": [
        { "expr": "sum(rate({app=\"api\", level=\"ERROR\"}[1m])) / sum(rate({app=\"api\", event_type=\"REQUEST\"}[1m])) * 100", "legendFormat": "Error %" }
      ],
      "fieldConfig": { "defaults": { "unit": "percent", "color": { "mode": "thresholds" }, "thresholds": { "mode": "absolute", "steps": [ { "color": "green", "value": null }, { "color": "red", "value": 1 } ] } } }
    },
    {
      "gridPos": { "h": 8, "w": 6, "x": 12, "y": 1 },
      "id": 3,
      "title": "Latency P99 (ms)",
      "type": "timeseries",
      "datasource": { "type": "loki", "uid": "${datasource}" },
      "targets": [
        { "expr": "quantile_over_time(0.99, {app=\"api\"} | json | unwrap latency_ms [1m])", "legendFormat": "P99" }
      ],
      "fieldConfig": { "defaults": { "unit": "ms" } }
    },
    {
      "gridPos": { "h": 8, "w": 6, "x": 18, "y": 1 },
      "id": 10,
      "title": "Slow Requests (>3s)",
      "type": "stat",
      "datasource": { "type": "loki", "uid": "${datasource}" },
      "targets": [
        { "expr": "count_over_time({app=\"api\"} |= \"[SLOW]\" [1h])", "legendFormat": "Slow Req Count" }
      ],
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "mode": "absolute", "steps": [ { "color": "green", "value": null }, { "color": "orange", "value": 1 }, { "color": "red", "value": 10 } ] } } }
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 9 },
      "id": 101,
      "panels": [],
      "title": "üìà Business Metrics (Growth & Activity)",
      "type": "row"
    },
    {
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 10 },
      "id": 4,
      "title": "New User Registrations (Hourly)",
      "type": "barchart",
      "datasource": { "type": "loki", "uid": "${datasource}" },
      "targets": [
        { "expr": "sum(count_over_time({app=\"api\"} |= \"Ïã†Í∑ú ÏÇ¨Ïö©Ïûê Îì±Î°ù ÏôÑÎ£å\" [1h]))", "legendFormat": "New Users" }
      ],
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "custom": { "opacity": 0.8 } } }
    },
    {
      "gridPos": { "h": 8, "w": 8, "x": 8, "y": 10 },
      "id": 5,
      "title": "User Profile Refresh (Activity)",
      "type": "timeseries",
      "datasource": { "type": "loki", "uid": "${datasource}" },
      "targets": [
        { "expr": "sum(count_over_time({app=\"api\"} |= \"ÏàòÎèô Ï†ÑÏ≤¥ Í∞±Ïã† ÏôÑÎ£å\" [1h]))", "legendFormat": "Refreshes" }
      ]
    },
    {
      "gridPos": { "h": 8, "w": 8, "x": 16, "y": 10 },
      "id": 6,
      "title": "GitHub API Cost Usage",
      "type": "timeseries",
      "datasource": { "type": "loki", "uid": "${datasource}" },
      "targets": [
        { "expr": "sum_over_time({app=\"api\"} | json | unwrap github_api_cost [1h])", "legendFormat": "Cost Consumed" }
      ],
      "fieldConfig": { "defaults": { "custom": { "drawStyle": "bars", "fillOpacity": 50 } } }
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 18 },
      "id": 102,
      "panels": [],
      "title": "‚öôÔ∏è Operations & Batch Jobs",
      "type": "row"
    },
    {
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 19 },
      "id": 7,
      "title": "Batch Job Execution Log",
      "type": "logs",
      "datasource": { "type": "loki", "uid": "${datasource}" },
      "targets": [
        { "expr": "{app=\"api\"} |= \"Î∞∞Ïπò Job\"" }
      ]
    },
    {
      "gridPos": { "h": 8, "w": 6, "x": 12, "y": 19 },
      "id": 8,
      "title": "Batch Failures (Today)",
      "type": "stat",
      "datasource": { "type": "loki", "uid": "${datasource}" },
      "targets": [
        { "expr": "count_over_time({app=\"api\"} |= \"Î∞∞Ïπò Job Ïã§Ìå®\" [24h])", "legendFormat": "Failures" }
      ],
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "mode": "absolute", "steps": [ { "color": "green", "value": null }, { "color": "red", "value": 1 } ] } } }
    },
    {
      "gridPos": { "h": 8, "w": 6, "x": 18, "y": 19 },
      "id": 11,
      "title": "Exception Type Breakdown",
      "type": "piechart",
      "datasource": { "type": "loki", "uid": "${datasource}" },
      "targets": [
        { "expr": "sum by (error_code) (count_over_time({app=\"api\", level=\"ERROR\"} | json [1h]))", "legendFormat": "{{error_code}}" }
      ],
      "pluginVersion": "10.0.0"
    },
    {
      "collapsed": true,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 27 },
      "id": 103,
      "panels": [
        {
          "gridPos": { "h": 10, "w": 24, "x": 0, "y": 28 },
          "id": 9,
          "title": "Live Error & Warn Logs",
          "type": "logs",
          "datasource": { "type": "loki", "uid": "${datasource}" },
          "targets": [
            { "expr": "{app=\"api\", level=~\"ERROR|WARN\"}" }
          ]
        }
      ],
      "title": "üîç Troubleshooting (Live Logs)",
      "type": "row"
    }
  ],
  "refresh": "10s",
  "schemaVersion": 38,
  "style": "dark",
  "tags": ["git-ranker", "ops", "business"],
  "templating": {
    "list": [
      {
        "name": "datasource",
        "query": "loki",
        "type": "datasource",
        "label": "Loki Data Source",
        "hide": 0,
        "includeAll": false,
        "multi": false
      }
    ]
  },
  "time": { "from": "now-6h", "to": "now" },
  "timezone": "browser",
  "title": "Git Ranker Integrated Ops Dashboard (v2)",
  "version": 1
}